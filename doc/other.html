<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>miscellaneous Rivet documentation</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <h2>Other Rivet Documentation</h2>

    <h3>Internals</h3>
    <ul>
      <li><b>Read the code!</b></li>
      <li>
	<b>Initialization</b><br>
	When Apache is started, (or when child Apache
	processes are started if a threaded Tcl is used),
	<code>tcl_init_stuff</code> is called, which creates
	a new interpreter, and initializes various things,
	like the <code>apache_channel</code> channel system.
	The caching system is also set up, and if there is a
	GlobalScript, it is run.
      </li>
      <li><b>Achan/apache_channel</b><br>

	The "Apache Channel" system was created so that it is possible
	to have an actual Tcl channel that we could redirect standard
	output to.  This lets us use, for instance, the regular "puts"
	command in .rvt pages.  It works by creating commands that
	write to memory that is slated to be sent to the client.
      </li>

      <li><b>Page parsing/execution</b><br>

	In <code>send_parsed_file</code> Each .rvt file is loaded and
	run within its own namespace.  No new interpreter is created
	for each page.  This lets you share variables, and most
	importantly, loaded modules, from a common parent (such as one
	of the InitScripts).  When a file is loaded, it is transformed
	into a Tcl script by putting everything outside of &lt;? and
	?&gt; into large <code>puts</code> statements.  When the
	script is complete, it is then inserted into the cache, for
	future use.  In fact, if the file modification information
	doesn't change, Rivet will execute the cached version of the
	script the next time it is encountered.
      </li>
      <li><b>Binary data</b><br>
	Rivet is capable of outputing binary data, such as
	images, or loading binary data with 'include'.
      </li>
    </ul>

    <h3>Upgrading From mod_dtcl and NeoWebScript</h3>
    <ul>
      <li>
	<b>TO BE WRITTEN</b>
      </li>
    </ul>
 </body>
</html>
    <!-- $Id$ -->