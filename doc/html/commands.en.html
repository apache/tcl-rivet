<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Rivet Tcl Commands and Variables</title><link rel="stylesheet" href="rivet.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.68.1"><link rel="start" href="index.en.html" title="Apache Rivet"><link rel="up" href="index.en.html" title="Apache Rivet"><link rel="prev" href="directives.en.html" title="Rivet Apache Directives"><link rel="next" href="commands.en.html#id4766456" title="var"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Rivet Tcl Commands and Variables</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="directives.en.html"><img src="images/prev.png" alt="Prev"></a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="commands.en.html#id4766456"><img src="images/next.png" alt="Next"></a></td></tr></table></div><div class="section" lang="en"><div class="titlepage"><div><div><hr><h2 class="title" style="clear: both"><a name="commands"></a>Rivet Tcl Commands and Variables</h2></div></div></div><div class="toc"><dl><dt><span class="refentrytitle"><a href="commands.en.html#id4766456">var</a></span><span class="refpurpose"> - get the value of a form variable.</span></dt><dt><span class="refentrytitle"><a href="commands.en.html#id4766933">upload</a></span><span class="refpurpose"> - handle a file uploaded by a client.</span></dt><dt><span class="refentrytitle"><a href="commands.en.html#id4767357">load_response</a></span><span class="refpurpose"> - load form variables into an array.</span></dt><dt><span class="refentrytitle"><a href="commands.en.html#id4767402">load_headers</a></span><span class="refpurpose"> - get client request's headers.</span></dt><dt><span class="refentrytitle"><a href="commands.en.html#id4767455">load_cookies</a></span><span class="refpurpose"> - get any cookie variables sent by the client.</span></dt><dt><span class="refentrytitle"><a href="commands.en.html#id4767508">load_env</a></span><span class="refpurpose"> - get the request's environment variables.</span></dt><dt><span class="refentrytitle"><a href="commands.en.html#id4767573">env</a></span><span class="refpurpose"> - Loads a single
	"environmental variable" into a Tcl variable.</span></dt><dt><span class="refentrytitle"><a href="commands.en.html#id4767623">include</a></span><span class="refpurpose"> - includes a file into the output stream without modification.</span></dt><dt><span class="refentrytitle"><a href="commands.en.html#id4767678">parse</a></span><span class="refpurpose"> - parses a Rivet template file.</span></dt><dt><span class="refentrytitle"><a href="commands.en.html#id4767736">headers</a></span><span class="refpurpose"> - set and parse HTTP headers.</span></dt><dt><span class="refentrytitle"><a href="commands.en.html#id4768071">makeurl</a></span><span class="refpurpose"> - construct url's based on hostname, port.</span></dt><dt><span class="refentrytitle"><a href="commands.en.html#id4768134">cookie</a></span><span class="refpurpose"> - get and set cookies.</span></dt><dt><span class="refentrytitle"><a href="commands.en.html#id4768298">clock_to_rfc850_gmt</a></span><span class="refpurpose"> - create a rfc850 time from [clock seconds].</span></dt><dt><span class="refentrytitle"><a href="commands.en.html#id4768348">html</a></span><span class="refpurpose"> - construct html tagged text.</span></dt><dt><span class="refentrytitle"><a href="commands.en.html#id4768418">incr0</a></span><span class="refpurpose"> - increment a variable or set it to 1 if nonexistant.</span></dt><dt><span class="refentrytitle"><a href="commands.en.html#id4768485">parray</a></span><span class="refpurpose"> - Tcl's parray with html formatting.</span></dt><dt><span class="refentrytitle"><a href="commands.en.html#id4768557">abort_page</a></span><span class="refpurpose"> - Stops outputing data to web page, similar in
	  purpose to PHP's die command.</span></dt><dt><span class="refentrytitle"><a href="commands.en.html#id4768611">no_body</a></span><span class="refpurpose"> - Prevents Rivet from sending any content.</span></dt><dt><span class="refentrytitle"><a href="commands.en.html#id4768652">escape_string</a></span><span class="refpurpose"> - convert a string into escaped characters.</span></dt><dt><span class="refentrytitle"><a href="commands.en.html#id4768707">escape_sgml_chars</a></span><span class="refpurpose"> - escape special SGML characters in a string.</span></dt><dt><span class="refentrytitle"><a href="commands.en.html#id4768758">escape_shell_command</a></span><span class="refpurpose"> - escape shell metacharacters in a string.</span></dt><dt><span class="refentrytitle"><a href="commands.en.html#id4768815">unescape_string</a></span><span class="refpurpose"> - unescape escaped characters in a string.</span></dt></dl></div><div class="refentry" lang="en"><a name="id4766456"></a><div class="titlepage"></div><div class="refnamediv"><h3>Name</h3><p><h3 style="text-indent: 3em">var, var_qs, var_post &#8212; get the value of a form variable.</h3></p></div><div class="refsynopsisdiv"><h3>Synopsis</h3><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">
	    var
	  </span>  (<span style="font-family:monospace; font-weight: bold;">get</span> | <span style="font-family:monospace; font-weight: bold;">list</span> | <span style="font-family:monospace; font-weight: bold;">exists</span> | <span style="font-family:monospace; font-weight: bold;">number</span> | <span style="font-family:monospace; font-weight: bold;">all</span>)</div></div><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">
	    var_qs
	  </span>  (<span style="font-family:monospace; font-weight: bold;">get</span> | <span style="font-family:monospace; font-weight: bold;">list</span> | <span style="font-family:monospace; font-weight: bold;">exists</span> | <span style="font-family:monospace; font-weight: bold;">number</span> | <span style="font-family:monospace; font-weight: bold;">all</span>)</div></div><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">
	    var_post
	  </span>  (<span style="font-family:monospace; font-weight: bold;">get</span> | <span style="font-family:monospace; font-weight: bold;">list</span> | <span style="font-family:monospace; font-weight: bold;">exists</span> | <span style="font-family:monospace; font-weight: bold;">number</span> | <span style="font-family:monospace; font-weight: bold;">all</span>)</div></div></div><div class="refsect1" lang="en"><h3>Description</h3><p style="width:90%">
	  The <span style="font-family:monospace"><span><strong class="command">var</strong></span></span> command retrieves information
	  about GET or POST variables sent to the script via client
	  request.  It treats both GET and POST variables the same,
	  regardless of their origin.  Note that there are two
	  additional forms of <span style="font-family:monospace"><span><strong class="command">var</strong></span></span>:
	  <span style="font-family:monospace"><span><strong class="command">var_qs</strong></span></span> and <span style="font-family:monospace"><span><strong class="command">var_post</strong></span></span>.
	  These two restrict the retrieval of information to
	  parameters arriving via the querystring
	  (?foo=bar&amp;bee=bop) or POSTing, respectively.
	</p><div class="variablelist"><dl><dt><span class="term">
	      <div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">var</span>   <span style="font-family:monospace; font-weight: bold;">get</span>  ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>varname</code></em></span>? ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>?<span class="optional">default</span>?</code></em></span>?</div></div>
	    </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:1.5ex ; padding .5ex">
		Returns the value of variable
		<em class="replaceable"><code>varname</code></em>
		as a string (even if there are multiple values).  If
		the variable doesn't exist as a GET or POST
		variable, the
		<em class="replaceable"><code>?<span class="optional">default</span>?</code></em>
		value is returned, otherwise "" - an empty string -
		is returned.
	      </div></div></dd><dt><span class="term">
	      <div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">var</span>   <span style="font-family:monospace; font-weight: bold;">list</span>  ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>varname</code></em></span>?</div></div>
	    </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:1.5ex ; padding .5ex">
		Returns the value of variable
		<em class="replaceable"><code>varname</code></em> as a
		list, if there are multiple values.
	      </div></div></dd><dt><span class="term">
	      <div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">var</span>   <span style="font-family:monospace; font-weight: bold;">exists</span>  ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>varname</code></em></span>?</div></div>
	    </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:1.5ex ; padding .5ex">
		Returns 1 if
		<em class="replaceable"><code>varname</code></em>
		exists, 0 if it doesn't.
	      </div></div></dd><dt><span class="term">
	      <div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">var</span>   <span style="font-family:monospace; font-weight: bold;">number</span> </div></div>
	    </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:1.5ex ; padding .5ex">
		Returns the number of variables.
	      </div></div></dd><dt><span class="term">
	      <div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">var</span>   <span style="font-family:monospace; font-weight: bold;">all</span> </div></div>
	    </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:1.5ex ; padding .5ex">
		Return a list of variable names and values.
	      </div></div></dd></dl></div><p style="width:90%">
	  See <a href="examples.en.html#variable_access" title="Example 3. Variable Access">Example 3, &#8220;Variable Access&#8221;</a>.
	</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="id4766933"></a><div class="titlepage"></div><div class="refnamediv"><h3>Name</h3><p><h3 style="text-indent: 3em">upload &#8212; handle a file uploaded by a client.</h3></p></div><div class="refsynopsisdiv"><h3>Synopsis</h3><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">upload</span>  (<span style="font-family:monospace; font-weight: bold;">channel</span> | <span style="font-family:monospace; font-weight: bold;">save</span> | <span style="font-family:monospace; font-weight: bold;">data</span> | <span style="font-family:monospace; font-weight: bold;">exists</span> | <span style="font-family:monospace; font-weight: bold;">size</span> | <span style="font-family:monospace; font-weight: bold;">type</span> | <span style="font-family:monospace; font-weight: bold;">filename</span>)</div></div></div><div class="refsect1" lang="en"><h3>Description</h3><p style="width:90%">The upload command is for file upload manipulation.
	  See the relevant Apache Directives to further configure the
	  behavior of this Rivet feature.</p><div class="variablelist"><dl><dt><span class="term">
	      <div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">upload</span>   <span style="font-family:monospace; font-weight: bold;">channel</span>  ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>uploadname</code></em></span>?</div></div>
	    </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:1.5ex ; padding .5ex">
		When given the name of a file upload
		<em class="replaceable"><code>uploadname</code></em>,
		returns a Tcl channel that can be used to access the
		uploaded file.
	      </div></div></dd><dt><span class="term">
	      <div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">upload</span>   <span style="font-family:monospace; font-weight: bold;">save</span>  ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>uploadname</code></em></span>? ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>filename</code></em></span>?</div></div>
	    </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:1.5ex ; padding .5ex">
		Saves the
		<em class="replaceable"><code>uploadname</code></em> in
		the file
		<em class="replaceable"><code>filename</code></em>.
	      </div></div></dd><dt><span class="term">
	      <div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">upload</span>   <span style="font-family:monospace; font-weight: bold;">data</span>  ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>uploadname</code></em></span>?</div></div>
	    </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:1.5ex ; padding .5ex">
		Returns data uploaded to the server.  This is binary clean
		- in other words, it will work even with files like
		images, executables, compressed files, and so on.
	      </div></div></dd><dt><span class="term">
	      <div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">upload</span>   <span style="font-family:monospace; font-weight: bold;">size</span>  ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>uploadname</code></em></span>?</div></div>
	    </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:1.5ex ; padding .5ex">
		Returns the size of the file uploaded.
	      </div></div></dd><dt><span class="term">
	      <div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">upload</span>   <span style="font-family:monospace; font-weight: bold;">type</span> </div></div>
	    </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:1.5ex ; padding .5ex">
		If the <code class="varname">Content-type</code> is set, it is
		returned, otherwise, an empty string.
	      </div></div></dd><dt><span class="term">
	      <div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">upload</span>   <span style="font-family:monospace; font-weight: bold;">filename</span>  ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>uploadname</code></em></span>?</div></div>
	    </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:1.5ex ; padding .5ex">
		Returns the filename on the remote host that uploaded the file.
	      </div></div></dd><dt><span class="term">
	      <div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">upload</span>   <span style="font-family:monospace; font-weight: bold;">names</span> </div></div>
	    </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:1.5ex ; padding .5ex">
		Returns the variable names, as a list, of all the files
		uploaded.
	      </div></div></dd></dl></div><p style="width:90%">
	  See <a href="examples.en.html#upload" title="Example 4. File Upload">Example 4, &#8220;File Upload&#8221;</a>.
	</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="id4767357"></a><div class="titlepage"></div><div class="refnamediv"><h3>Name</h3><p><h3 style="text-indent: 3em">load_response &#8212; load form variables into an array.</h3></p></div><div class="refsynopsisdiv"><h3>Synopsis</h3><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">load_response</span>  ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>arrayName</code></em></span>?</div></div></div><div class="refsect1" lang="en"><h3>Description</h3>
	Load any form variables passed to this page into an
	array.
      </div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="id4767402"></a><div class="titlepage"></div><div class="refnamediv"><h3>Name</h3><p><h3 style="text-indent: 3em">load_headers &#8212; get client request's headers.</h3></p></div><div class="refsynopsisdiv"><h3>Synopsis</h3><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">load_headers</span>  ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>array_name</code></em></span>?</div></div></div><div class="refsect1" lang="en"><h3>Description</h3><p style="width:90%">
	  Load the headers that come from a client request into the
	  provided array name, or use headers if no
	  name is provided.
	</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="id4767455"></a><div class="titlepage"></div><div class="refnamediv"><h3>Name</h3><p><h3 style="text-indent: 3em">load_cookies &#8212; get any cookie variables sent by the client.</h3></p></div><div class="refsynopsisdiv"><h3>Synopsis</h3><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">load_cookies</span>  ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>array_name</code></em></span>?</div></div></div><div class="refsect1" lang="en"><h3>Description</h3></div><p style="width:90%">
	Load the array of cookie variables into the specified
	array name.  Uses array cookies by
	default.
      </p></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="id4767508"></a><div class="titlepage"></div><div class="refnamediv"><h3>Name</h3><p><h3 style="text-indent: 3em">load_env &#8212; get the request's environment variables.</h3></p></div><div class="refsynopsisdiv"><h3>Synopsis</h3><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">load_env</span>  ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>array_name</code></em></span>?</div></div></div><div class="refsect1" lang="en"><h3>Description</h3><p style="width:90%">
	  Load the array of environment variables into the specified
	  array name.  Uses array ::request::env by
	  default.
	</p><p style="width:90%">
	  As Rivet pages are run in the ::request
	  namespace, it isn't necessary to qualify the array name
	  for most uses - it's ok to access it as
	  env.
	</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="id4767573"></a><div class="titlepage"></div><div class="refnamediv"><h3>Name</h3><p><h3 style="text-indent: 3em">env &#8212; Loads a single
	"environmental variable" into a Tcl variable.</h3></p></div><div class="refsynopsisdiv"><h3>Synopsis</h3><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">env</span>  ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>varName</code></em></span>?</div></div></div><div class="refsect1" lang="en"><h3>Description</h3><p style="width:90%">
	  If it is only necessary to load one environmental variable,
	  this command may be used to avoid the overhead of loading
	  and storing the entire array.
	</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="id4767623"></a><div class="titlepage"></div><div class="refnamediv"><h3>Name</h3><p><h3 style="text-indent: 3em">include &#8212; includes a file into the output stream without modification.</h3></p></div><div class="refsynopsisdiv"><h3>Synopsis</h3><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">include</span>  ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>filename_name</code></em></span>?</div></div></div><div class="refsect1" lang="en"><h3>Description</h3><p style="width:90%">
	  Include a file without parsing it for processing tags &lt;?
	  and ?&gt;.  This is the best way to include an HTML file or
	  any other static content.
	</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="id4767678"></a><div class="titlepage"></div><div class="refnamediv"><h3>Name</h3><p><h3 style="text-indent: 3em">parse &#8212; parses a Rivet template file.</h3></p></div><div class="refsynopsisdiv"><h3>Synopsis</h3><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">parse</span>  ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>filename</code></em></span>?</div></div></div><div class="refsect1" lang="en"><h3>Description</h3><p style="width:90%">
	  Like the Tcl <span style="font-family:monospace"><span><strong class="command">source</strong></span></span> command, but also
	  parses for Rivet &lt;?  and ?&gt; processing tags.  Using
	  this command, you can use one .rvt file from another.
	</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="id4767736"></a><div class="titlepage"></div><div class="refnamediv"><h3>Name</h3><p><h3 style="text-indent: 3em">headers &#8212; set and parse HTTP headers.</h3></p></div><div class="refsynopsisdiv"><h3>Synopsis</h3><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">headers</span>  (<span style="font-family:monospace; font-weight: bold;">set</span> | <span style="font-family:monospace; font-weight: bold;">redirect</span> | <span style="font-family:monospace; font-weight: bold;">add</span> | <span style="font-family:monospace; font-weight: bold;">type</span> | <span style="font-family:monospace; font-weight: bold;">numeric</span>)</div></div></div><div class="refsect1" lang="en"><h3>Description</h3><p style="width:90%">
	  The <span style="font-family:monospace"><span><strong class="command">headers</strong></span></span> command is for setting and
	  parsing HTTP headers.
	</p><div class="variablelist"><dl><dt><span class="term"><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">headers</span>   <span style="font-family:monospace; font-weight: bold;">set</span>  ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>headername</code></em></span>? ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>value</code></em></span>?</div></div>
	    </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:1.5ex ; padding .5ex">
		Set arbitrary header names and values.
	      </div></div></dd><dt><span class="term">
	      <div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">headers</span>   <span style="font-family:monospace; font-weight: bold;">redirect</span>  ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>uri</code></em></span>?</div></div>
	    </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:1.5ex ; padding .5ex">
		Redirect from the current page to a new
		URI. <span class="emphasis"><em>Must</em></span> be done in the first block
		of TCL code.
	      </div></div></dd><dt><span class="term">
	      <div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">headers</span>   <span style="font-family:monospace; font-weight: bold;">add</span>  ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>headername</code></em></span>? ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>value</code></em></span>?</div></div>
	    </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:1.5ex ; padding .5ex">Add text to header
		<code class="varname">headername</code>.</div></div></dd><dt><span class="term"><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">headers</span>   <span style="font-family:monospace; font-weight: bold;">type</span>  ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>content-type</code></em></span>?</div></div>
	    </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:1.5ex ; padding .5ex">
		This command sets the <code class="constant">Content-type</code>
		header returned by the script, which is useful if you wish
		to send content other than HTML with Rivet - PNG or jpeg
		images, for example.
	      </div></div></dd><dt><span class="term">
	      <div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">headers</span>   <span style="font-family:monospace; font-weight: bold;">numeric</span>  ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>response code</code></em></span>?</div></div>
	    </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:1.5ex ; padding .5ex">Set a numeric response code, such as 200, 404 or 500.
	      </div></div></dd></dl></div></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="id4768071"></a><div class="titlepage"></div><div class="refnamediv"><h3>Name</h3><p><h3 style="text-indent: 3em">makeurl &#8212; construct url's based on hostname, port.</h3></p></div><div class="refsynopsisdiv"><h3>Synopsis</h3><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">makeurl</span>  ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>filename</code></em></span>?</div></div></div><div class="refsect1" lang="en"><h3>Description</h3><p style="width:90%">
	  Create a self referencing URL from a filename.  For example:
	  </p><pre style="background:#bbffbb ; width:90ex ; margin: 2ex ;      padding: 1ex; border: solid black 1px ; white-space: pre;      font-family:monospace ; " class="programlisting">makeurl /tclp.gif</pre><p style="width:90%">
	  returns
	  <code class="computeroutput">http://[hostname]:[port]/tclp.gif</code>.
	  where hostname and port are the hostname and port of the
	  server in question.
	</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="id4768134"></a><div class="titlepage"></div><div class="refnamediv"><h3>Name</h3><p><h3 style="text-indent: 3em">cookie &#8212; get and set cookies.</h3></p></div><div class="refsynopsisdiv"><h3>Synopsis</h3><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">cookie</span>  ?<span style="font-family:monospace; font-weight: bold;">set</span>? ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>cookieName</code></em></span>? ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>?<span class="optional">cookiValue</span>?</code></em></span>? ?<span style="font-family:monospace; font-weight: bold;">-days <em class="replaceable"><code>expireInDays</code></em></span>? ?<span style="font-family:monospace; font-weight: bold;">-hours <em class="replaceable"><code>expireInHours</code></em></span>? ?<span style="font-family:monospace; font-weight: bold;">-minutes <em class="replaceable"><code>expireInMinutes</code></em></span>? ?<span style="font-family:monospace; font-weight: bold;">-expires <em class="replaceable"><code>Wdy, DD-Mon-YYYY HH:MM:SS GMT</code></em></span>? ?<span style="font-family:monospace; font-weight: bold;">-path <em class="replaceable"><code>uriPathCookieAppliesTo</code></em></span>? ?<span style="font-family:monospace; font-weight: bold;">-secure <em class="replaceable"><code>1/0</code></em></span>?</div></div><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">cookie</span>  ?<span style="font-family:monospace; font-weight: bold;">get</span>? ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>cookieName</code></em></span>?</div></div></div><div class="refsect1" lang="en"><h3>Description</h3><p style="width:90%">
	  <span style="font-family:monospace"><span><strong class="command">cookie</strong></span></span> gets or sets a cookie.  When you
	  get a cookie, the command returns the value of the cookie,
	  or an empty string if no cookie exists.
	</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="id4768298"></a><div class="titlepage"></div><div class="refnamediv"><h3>Name</h3><p><h3 style="text-indent: 3em">clock_to_rfc850_gmt &#8212; create a rfc850 time from [clock seconds].</h3></p></div><div class="refsynopsisdiv"><h3>Synopsis</h3><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">clock_to_rfc850_gmt</span>  ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>seconds</code></em></span>?</div></div></div><div class="refsect1" lang="en"><h3>Description</h3><p style="width:90%">
	  Convert an integer-seconds-since-1970 click value to
	  RFC850 format, with the additional requirement that it be
	  GMT only.
	</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="id4768348"></a><div class="titlepage"></div><div class="refnamediv"><h3>Name</h3><p><h3 style="text-indent: 3em">html &#8212; construct html tagged text.</h3></p></div><div class="refsynopsisdiv"><h3>Synopsis</h3><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">html</span>  ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>string</code></em></span>? ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>arg</code></em></span>...?</div></div></div><div class="refsect1" lang="en"><h3>Description</h3><p style="width:90%">
	  Print text with the added ability to pass HTML tags
	  following the string.  Example:
	  </p><pre style="background:#bbffbb ; width:90ex ; margin: 2ex ;      padding: 1ex; border: solid black 1px ; white-space: pre;      font-family:monospace ; " class="programlisting">html "Test" b i</pre><p style="width:90%">
	  produces: <code class="computeroutput">&lt;b&gt;&lt;i&gt;Test&lt;/i&gt;&lt;/b&gt;</code>
	</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="id4768418"></a><div class="titlepage"></div><div class="refnamediv"><h3>Name</h3><p><h3 style="text-indent: 3em">incr0 &#8212; increment a variable or set it to 1 if nonexistant.</h3></p></div><div class="refsynopsisdiv"><h3>Synopsis</h3><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">incr0</span>  ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>varname</code></em></span>? ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>num</code></em></span>?</div></div></div><div class="refsect1" lang="en"><h3>Description</h3><p style="width:90%">
	  Increment a variable
	  <em class="replaceable"><code>varname</code></em> by
	  <em class="replaceable"><code>num</code></em>.  If the
	  variable doesn't exist, create it instead of returning an
	  error.
	</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="id4768485"></a><div class="titlepage"></div><div class="refnamediv"><h3>Name</h3><p><h3 style="text-indent: 3em">parray &#8212; Tcl's <span style="font-family:monospace"><span><strong class="command">parray</strong></span></span> with html formatting.</h3></p></div><div class="refsynopsisdiv"><h3>Synopsis</h3><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">parray</span>  ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>arrayName</code></em></span>? ?<span style="font-family:monospace; font-weight: bold;"><em class="replaceable"><code>?<span class="optional">pattern</span>?</code></em></span>?</div></div></div><div class="refsect1" lang="en"><h3>Description</h3><p style="width:90%">
	  An html version of the standard Tcl
	  <span style="font-family:monospace"><span><strong class="command">parray</strong></span></span> command.  Displays the entire
	  contents of an array in a sorted, nicely-formatted way.
	  Mostly used for debugging purposes.
	</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="id4768557"></a><div class="titlepage"></div><div class="refnamediv"><h3>Name</h3><p><h3 style="text-indent: 3em">abort_page &#8212; Stops outputing data to web page, similar in
	  purpose to PHP's <span style="font-family:monospace"><span><strong class="command">die</strong></span></span> command.</h3></p></div><div class="refsynopsisdiv"><h3>Synopsis</h3><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">abort_page</span> </div></div></div><div class="refsect1" lang="en"><h3>Description</h3><p style="width:90%">This command flushes the
	output buffer and stops the Tcl script from sending any more
	data to the client.  A normal Tcl script might use the
	<span style="font-family:monospace"><span><strong class="command">exit</strong></span></span> command, but that cannot be used in
	Rivet without actually exiting the apache child
	process!</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="id4768611"></a><div class="titlepage"></div><div class="refnamediv"><h3>Name</h3><p><h3 style="text-indent: 3em">no_body &#8212; Prevents Rivet from sending any content.</h3></p></div><div class="refsynopsisdiv"><h3>Synopsis</h3><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">no_body</span> </div></div></div><div class="refsect1" lang="en"><h3>Description</h3><p style="width:90%">
	  This command is useful for situations where it is necessary
	  to only return HTTP headers and no actual content.  For
	  instance, when returning a 304 redirect.
	</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="id4768652"></a><div class="titlepage"></div><div class="refnamediv"><h3>Name</h3><p><h3 style="text-indent: 3em">escape_string &#8212; convert a string into escaped characters.</h3></p></div><div class="refsynopsisdiv"><h3>Synopsis</h3><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">escape_string</span>  ?<span style="font-family:monospace; font-weight: bold;">string</span>?</div></div></div><div class="refsect1" lang="en"><h3>Description</h3><p style="width:90%">
	  Scans through each character in the specified string looking
	  for special characters, escaping them as needed, mapping
	  special characters to a quoted hexadecimal equivalent,
	  returning the result.
	</p><p style="width:90%">
	This is useful for quoting strings that are going to be
	part of a URL.
	</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="id4768707"></a><div class="titlepage"></div><div class="refnamediv"><h3>Name</h3><p><h3 style="text-indent: 3em">escape_sgml_chars &#8212; escape special SGML characters in a string.</h3></p></div><div class="refsynopsisdiv"><h3>Synopsis</h3><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">escape_sgml_chars</span>  ?<span style="font-family:monospace; font-weight: bold;">string</span>?</div></div></div><div class="refsect1" lang="en"><h3>Description</h3><p style="width:90%">
	  Scans through each character in the specified string looking
	  for any special (with respect to SGML, and hence HTML) characters
	  from the specified string, and returns the result.  
	  For example, the right angle
	  bracket is escaped to the corrected ampersand gt symbol.
	</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="id4768758"></a><div class="titlepage"></div><div class="refnamediv"><h3>Name</h3><p><h3 style="text-indent: 3em">escape_shell_command &#8212; escape shell metacharacters in a string.</h3></p></div><div class="refsynopsisdiv"><h3>Synopsis</h3><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">escape_shell_command</span>  ?<span style="font-family:monospace; font-weight: bold;">string</span>?</div></div></div><div class="refsect1" lang="en"><h3>Description</h3><p style="width:90%">
	  Scans through each character in the specified string looking
	  for any shell metacharacters, such as asterisk, less than and
	  greater than, parens, square brackets, curly brackets, angle 
	  brackets, dollar signs, backslashes, semicolons, ampersands,
	  vertical bars, etc.
	</p><p style="width:90%">
	  For each metacharacter found, it is quoted in the result by
	  prepending it with a backslash, returning the result.
	</p></div></div><div class="refentry" lang="en"><div class="refentry.separator"><hr></div><a name="id4768815"></a><div class="titlepage"></div><div class="refnamediv"><h3>Name</h3><p><h3 style="text-indent: 3em">unescape_string &#8212; unescape escaped characters in a string.</h3></p></div><div class="refsynopsisdiv"><h3>Synopsis</h3><div class="cmdsynopsis" style="width:80%"><div style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">unescape_string</span>  ?<span style="font-family:monospace; font-weight: bold;">string</span>?</div></div></div><div class="refsect1" lang="en"><h3>Description</h3><p style="width:90%">
	  Scans through each character in the specified string looking
	  for escaped character sequences (characters containing a
	  percent sign and two hexadecimal characters, unescaping them 
	  back to their original character values, as needed, also mapping
	  plus signs to spaces, and returning the result.
	</p><p style="width:90%">
	This is useful for unquoting strings that have been quoted to
	be part of a URL.
	</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="directives.en.html"><img src="images/prev.png" alt="Prev"></a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="commands.en.html#id4766456"><img src="images/next.png" alt="Next"></a></td></tr><tr><td width="40%" align="left" valign="top">Rivet Apache Directives </td><td width="20%" align="center"><a accesskey="h" href="index.en.html"><img src="images/home.png" alt="Home"></a></td><td width="40%" align="right" valign="top"> var</td></tr></table></div></body></html>
