<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta content="text/html; charset=ISO-8859-1" http-equiv="Content-Type"><title>Rivet Tcl Commands and Variables</title><meta name="generator" content="DocBook XSL Stylesheets V1.50.0"><link rel="home" href="index.html" title="Apache Rivet"><link rel="up" href="index.html" title="Apache Rivet"><link rel="previous" href="directives.html" title="Rivet Apache Directives"><link rel="next" href="examples.html" title="Examples and Usage"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Rivet Tcl Commands and Variables</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="directives.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="examples.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><hr><h2 class="title" style="clear: both"><a name="commands"></a>Rivet Tcl Commands and Variables</h2></div></div><div class="variablelist"><dl><dt><span class="term">
	  <div class="cmdsynopsis" style="width:80%"><span style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">var</span>  (<span style="font-family:monospace; text-decoration:underline">get</span> | <span style="font-family:monospace; text-decoration:underline">list</span> | <span style="font-family:monospace; text-decoration:underline">exists</span> | <span style="font-family:monospace; text-decoration:underline">number</span> | <span style="font-family:monospace; text-decoration:underline">all</span>)</span></div>
	</span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
	    The <span style="font-family:monospace"><b>var</b></span> command manipulates variables
	    set by the user.
	  </div><div class="variablelist"><dl><dt><span class="term">
		<div class="cmdsynopsis" style="width:80%"><span style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-family:monospace; text-decoration:underline">get</span> <span style="font-family:monospace; text-decoration:underline"><i><tt>varname</tt></i></span> <span style="font-family:monospace; text-decoration:underline"><i><tt>?default?</tt></i></span></span></div>
	      </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
		  Returns the value of variable
		  <tt><span style="text-decoration:underline"><i><tt>varname</tt></i></span></tt>
		  as a string (even if there are multiple values).  If
		  the variable doesn't exist as a GET or POST
		  variable, the
		  <tt><span style="text-decoration:underline"><i><tt>?default?</tt></i></span></tt>
		  value is returned, otherwise an error is thrown.
		</div></div></dd><dt><span class="term">
		<div class="cmdsynopsis" style="width:80%"><span style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-family:monospace; text-decoration:underline">list</span> <span style="font-family:monospace; text-decoration:underline"><i><tt>varname</tt></i></span></span></div>
	      </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
		  Returns the value of variable
		  <tt><span style="text-decoration:underline"><i><tt>varname</tt></i></span></tt> as a
		  list, if there are multiple values.
		</div></div></dd><dt><span class="term">
		<div class="cmdsynopsis" style="width:80%"><span style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-family:monospace; text-decoration:underline">exists</span> <span style="font-family:monospace; text-decoration:underline"><i><tt>varname</tt></i></span></span></div>
	      </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
		  Returns 1 if
		  <tt><span style="text-decoration:underline"><i><tt>varname</tt></i></span></tt>
		  exists, 0 if it doesn't.
		</div></div></dd><dt><span class="term">
		<div class="cmdsynopsis" style="width:80%"><span style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-family:monospace; text-decoration:underline">number</span></span></div>
	      </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
		  Returns the number of variables.
		</div></div></dd><dt><span class="term">
		<div class="cmdsynopsis" style="width:80%"><span style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-family:monospace; text-decoration:underline">all</span></span></div>
	      </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
		  Return a list of variable names and values.
		</div></div></dd></dl></div><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
	    See the example.
	  </div></div></dd></dl></div><div class="variablelist"><dl><dt><span class="term">
	  <div class="cmdsynopsis" style="width:80%"><span style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">upload</span>  (<span style="font-family:monospace; text-decoration:underline">channel</span> | <span style="font-family:monospace; text-decoration:underline">save</span> | <span style="font-family:monospace; text-decoration:underline">data</span> | <span style="font-family:monospace; text-decoration:underline">exists</span> | <span style="font-family:monospace; text-decoration:underline">size</span> | <span style="font-family:monospace; text-decoration:underline">type</span> | <span style="font-family:monospace; text-decoration:underline">filename</span>)</span></div>
	</span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">The upload command is for file upload manipulation.
	    See the relevant Apache Directives to further configure the
	    behavior of this Rivet feature.</div><div class="variablelist"><dl><dt><span class="term">
		<div class="cmdsynopsis" style="width:80%"><span style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-family:monospace; text-decoration:underline">channel</span> <span style="font-family:monospace; text-decoration:underline"><i><tt>uploadname</tt></i></span></span></div>
	      </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
		  When given the name of a file upload
		  <tt><span style="text-decoration:underline"><i><tt>uploadname</tt></i></span></tt>,
		  returns a Tcl channel that can be used to access the
		  uploaded file.
		</div></div></dd><dt><span class="term">
		<div class="cmdsynopsis" style="width:80%"><span style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-family:monospace; text-decoration:underline">save</span> <span style="font-family:monospace; text-decoration:underline"><i><tt>uploadname</tt></i></span> <span style="font-family:monospace; text-decoration:underline"><i><tt>filename</tt></i></span></span></div>
	      </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
		  Saves the
		  <tt><span style="text-decoration:underline"><i><tt>uploadname</tt></i></span></tt> in
		  the file
		  <tt><span style="text-decoration:underline"><i><tt>filename</tt></i></span></tt>.
		</div></div></dd><dt><span class="term">
		<div class="cmdsynopsis" style="width:80%"><span style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-family:monospace; text-decoration:underline">data</span> <span style="font-family:monospace; text-decoration:underline"><i><tt>uploadname</tt></i></span></span></div>
	      </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
		  Returns data uploaded to the server.  This is binary clean
		  - in other words, it will work even with files like
		  images, executables, compressed files, and so on.
		</div></div></dd><dt><span class="term">
		<div class="cmdsynopsis" style="width:80%"><span style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-family:monospace; text-decoration:underline">size</span> <span style="font-family:monospace; text-decoration:underline"><i><tt>uploadname</tt></i></span></span></div>
	      </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
		  Returns the size of the file uploaded.
		</div></div></dd><dt><span class="term">
		<div class="cmdsynopsis" style="width:80%"><span style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-family:monospace; text-decoration:underline">type</span></span></div>
	      </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
		  If the <tt>Content-type</tt> is set, it is
		  returned, otherwise, an empty string.
		</div></div></dd><dt><span class="term">
		<div class="cmdsynopsis" style="width:80%"><span style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-family:monospace; text-decoration:underline">filename</span> <span style="font-family:monospace; text-decoration:underline"><i><tt>uploadname</tt></i></span></span></div>
	      </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
		  Returns the filename on the remote host that uploaded the file.
		</div></div></dd><dt><span class="term">
		<div class="cmdsynopsis" style="width:80%"><span style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-family:monospace; text-decoration:underline">names</span></span></div>
	      </span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
		  Returns the variable names, as a list, of all the files
		  uploaded.
		</div></div></dd></dl></div><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
	    Please see the upload example.
	  </div></div></dd></dl></div><div class="variablelist"><dl><dt><span class="term">
	  <div class="cmdsynopsis" style="width:80%"><span style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">load_env</span>  ?<span style="font-family:monospace; text-decoration:underline"><i><tt>array_name</tt></i></span>?</span></div>
	</span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
	    Load the array of environment variables into the specified
	    array name.  Uses array <tt><span style="text-decoration:underline">::request::env</span></tt> by
	    default.
	  </div><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
	    As Rivet pages are run in the <tt><span style="text-decoration:underline">::request</span></tt>
	    namespace, it isn't necessary to qualify the array name
	    for most uses - it's ok to access it as
	    <tt><span style="text-decoration:underline">env</span></tt>.
	  </div></div></dd><dt><span class="term">
	  <div class="cmdsynopsis" style="width:80%"><span style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">load_headers</span>  <span style="font-family:monospace; text-decoration:underline"><i><tt>array_name</tt></i></span></span></div>
	</span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
	    Load the headers that come from a client request into the
	    provided array name, or use <tt><span style="text-decoration:underline">headers</span></tt> if no
	    name is provided.
	  </div></div></dd><dt><span class="term">
	  <div class="cmdsynopsis" style="width:80%"><span style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">load_cookies</span>  ?<span style="font-family:monospace; text-decoration:underline"><i><tt>array_name</tt></i></span>?</span></div>
	</span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
	    Load the array of cookie variables into the specified
	    array name.  Uses array <tt><span style="text-decoration:underline">cookies</span></tt> by
	    default.
	  </div></div></dd><dt><span class="term">
	  <div class="cmdsynopsis" style="width:80%"><span style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">include</span>  <span style="font-family:monospace; text-decoration:underline"><i><tt>filename_name</tt></i></span></span></div>
	</span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
	    Include a file without parsing it for processing tags &lt;?
	    and ?&gt;.  This is the best way to include an HTML file or
	    any other static content.
	  </div></div></dd><dt><span class="term">
	  <div class="cmdsynopsis" style="width:80%"><span style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">parse</span>  <span style="font-family:monospace; text-decoration:underline"><i><tt>filename</tt></i></span></span></div>
	</span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
	    Like the Tcl <span style="font-family:monospace"><b>source</b></span> command, but also
	    parses for Rivet &lt;?  and ?&gt; processing tags.  Using
	    this command, you can use one .rvt file from another.
	  </div></div></dd><dt><span class="term">
	  <div class="cmdsynopsis" style="width:80%"><span style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">headers</span>  (<span style="font-family:monospace; text-decoration:underline">set</span> | <span style="font-family:monospace; text-decoration:underline">redirect</span> | <span style="font-family:monospace; text-decoration:underline">add</span> | <span style="font-family:monospace; text-decoration:underline">type</span> | <span style="font-family:monospace; text-decoration:underline">numeric</span>)</span></div>
	</span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
	    The <span style="font-family:monospace"><b>headers</b></span> command is for setting and
	    parsing HTTP headers.
	  </div><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
	    <div class="variablelist"><dl><dt><span class="term">
		  <div class="cmdsynopsis" style="width:80%"><span style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-family:monospace; text-decoration:underline">redirect</span> <span style="font-family:monospace; text-decoration:underline"><i><tt>uri</tt></i></span></span></div>
		</span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
		    Redirect from the current page to a new
		    URI. <span class="emphasis"><em>Must</em></span> be done in the first block
		    of TCL code.
		  </div></div></dd><dt><span class="term">
		  <div class="cmdsynopsis" style="width:80%"><span style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-family:monospace; text-decoration:underline">setcookie</span> <span style="font-family:monospace; text-decoration:underline">-name</span> <span style="font-family:monospace; text-decoration:underline"><i><tt>cookie-name</tt></i></span> <span style="font-family:monospace; text-decoration:underline">-value</span> <span style="font-family:monospace; text-decoration:underline"><i><tt>cookie-value</tt></i></span> ?<span style="font-family:monospace; text-decoration:underline">-expires <i><tt>date/time</tt></i></span>? ?<span style="font-family:monospace; text-decoration:underline">-domain <i><tt>domain</tt></i></span>? ?<span style="font-family:monospace; text-decoration:underline">-path <i><tt>path</tt></i></span>? ?<span style="font-family:monospace; text-decoration:underline">-secure</span>?</span></div>
		</span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
		    This command is for setting cookies for the server to send
		    to the client.  <tt><span style="text-decoration:underline">cookie-name</span></tt> is the name
		    of the cookie, <tt><span style="text-decoration:underline">cookie-value</span></tt> is the data
		    associated with the cookie.  <tt><span style="text-decoration:underline">-expires</span></tt>
		    sets an expiration date for the cookie, and must be in the
		    format <tt>'DD-Mon-YY HH:MM:SS'</tt>,
		    <tt><span style="text-decoration:underline">-path</span></tt> sets the path for which the cookie
		    is valid, and <tt><span style="text-decoration:underline">-secure</span></tt> specifies that the
		    cookie is only to be transmitted if the connection is
		    secure (HTTPS).
		  </div></div></dd><dt><span class="term"><div class="cmdsynopsis" style="width:80%"><span style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-family:monospace; text-decoration:underline">type</span> <span style="font-family:monospace; text-decoration:underline"><i><tt>content-type</tt></i></span></span></div>
		</span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
		    This command sets the <tt>Content-type</tt>
		    header returned by the script, which is useful if you wish
		    to send content other than HTML with Rivet - PNG or jpeg
		    images, for example.
		  </div></div></dd><dt><span class="term"><div class="cmdsynopsis" style="width:80%"><span style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-family:monospace; text-decoration:underline">set</span> <span style="font-family:monospace; text-decoration:underline"><i><tt>headername</tt></i></span> <span style="font-family:monospace; text-decoration:underline"><i><tt>value</tt></i></span></span></div>
		</span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
		    Set arbitrary header names and values.
		  </div></div></dd></dl></div>
	  </div></div></dd><dt><span class="term">
	  <div class="cmdsynopsis" style="width:80%"><span style="background:#bbbbff ; margin:1ex ; padding:.4ex ;  word-spacing:1ex "><span style="font-weight:bold ; font-family:monospace">makeurl</span>  <span style="font-family:monospace; text-decoration:underline"><i><tt>filename</tt></i></span></span></div>
	</span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style=" margin:1ex ; margin-bottom:1.5ex ; padding .5ex">
	    Create a self referencing URL from a filename.  For example:
	    <pre style="background:#bbffbb ; width:90ex ; margin: 2ex ;      padding: 1ex; border: solid black 1px ; white-space: pre;      font-family:monospace ; " class="programlisting">makeurl /tclp.gif</pre>
	    returns
	    <tt>http://[hostname]:[port]/tclp.gif</tt>.
	    where hostname and port are the hostname and port of the
	    server in question.
	  </div></div></dd></dl></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="directives.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="index.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="examples.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Rivet Apache Directives </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Examples and Usage</td></tr></table></div></body></html>
